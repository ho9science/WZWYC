<meta charset="utf-8">
<style>
    path {
        stroke: white;
        stroke-width: 0.25px;
        fill: grey;
    }
    .zone_label {
        font-weight: 900;
    }
    .a:hover {
        fill: #FFA500;
        cursor: pointer;
        opacity: 0.5;
    }
    .b:hover {
        fill: #FFD700;
        cursor: pointer;
        opacity: 0.5;
    }
    .c:hover {
        fill: #E06F1F;
        cursor: pointer;
        opacity: 0.5;
    }
    .d:hover {
        fill: #FF0000;
        cursor: pointer;
        opacity: 0.5;
    }
    .e:hover {
        fill: #FF1A40;
        cursor: pointer;
        opacity: 0.5;
    }
    .f:hover {
        fill: #FF00FF;
        cursor: pointer;
        opacity: 0.5;
    }
    .g:hover {
        fill: #8A2BE2;
        cursor: pointer;
        opacity: 0.5;
    }
    .h:hover {
        fill: #0000FF;
        cursor: pointer;
        opacity: 0.5;
    }
    .i:hover {
        fill: #00FF00;
        cursor: pointer;
        opacity: 0.5;
    }
    .j:hover {
        fill: #454D66;
        cursor: pointer;
        opacity: 0.5;
    }
</style>

<body>
    <h1>밸런스게임</h1>
    <div id="main"></div>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <script>
        var width = 1060,
            height = 500;

        var projection = d3.geoMercator()
            .center([0, 35])
            .scale(135)
            .rotate([-160, 0]); 

        var svg = d3.select("div").append("svg")
            .attr("width", width)
            .attr("height", height);

        d3.json("section.json").then(function (data) {
            svg.append("g").selectAll("polygon")
                .data(data.Polygons)
                .enter().append("polygon")
                .attr("points", function (d) {
                    return d.points.map(function (d) { return [d.x, d.y].join(","); }).join(" ");
                })
                .attr("stroke", "black")
                .attr("stroke-width", 2)
                .attr("name", function (d) {
                    return d.name;
                })
                .attr("class", function (d) {
                    return d.name;
                })
                .attr("fill", "transparent")
                .on("click", handleMouseClick);
            svg.selectAll("text")
                .data(data.Polygons)
                .enter()
                .append("text")
                .attr("class", "zone_label")
                .attr("x", function(d){return d.center.x})
                .attr("y", function(d){return d.center.y})
                .text(function (d) { return d.name; });
        });

        var g = svg.append("g");

        var path = d3.geoPath()
            .projection(projection);

        d3.json("world-110m2.json").then(function (topology) {

            g.selectAll("path")
                .data(topojson.feature(topology, topology.objects.countries).features)
                .enter().append("path")
                .attr("d", path);

        });

        var country = {};
        fetch("country.json").then((response) => response.json())
        .then((data) => country = data);

        function handleMouseClick() {
            var clicked_name = d3.select(this).attr("name");
            const random = Math.floor(Math.random() * country[clicked_name].length);
            
            alert("당신은 구역" + clicked_name + "를 선택하셨습니다.");
            alert(country[clicked_name][random]+"에서 태어났습니다.");
            
        }

        function handleMouseOver() {
            d3.select(this).style("fill", "red");
        }

        function handleMouseOut() {
            d3.select(this).style("fill", "none");
        }
        
    </script>

</body>

</html>